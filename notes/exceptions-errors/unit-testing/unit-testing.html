<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This note aims at providing a brief introduction to the concept of Unit Testing in computer programming and the unit testing frameworks in Python.">
<meta name="keywords" content="unit_testingerror_handlingpython,  unit_testing, error_handling, python">
<title>Unit testing | Data Science with Python</title>
<link rel="stylesheet" href="/python/css/prismOkaidia.css">
<script src="/python/js/prismOkaidia.js"></script>
<!--
<link rel="stylesheet" href="/python/css/syntax.css">
-->
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="/python/css/bootstrap.min.css">



<link rel="stylesheet" href="/python/css/customstyles.css">
<link rel="stylesheet" href="/python/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/python/css/theme-cdslab.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/python/js/jquery.navgoco.min.js"></script>
<!-- make sidebar non-accordion -->
<script src="/python/js/lockScrollbarPosition.js"></script>
<!-- make sidebar non-accordion -->
<script type="text/javascript">
    $(document).ready(function() {
        $('.sidenav').navgoco({
              accordion: false,
              caret: '<span class="caret"></span>',
              openClass: 'open',
              save: true,
              cookie: {
                  name: 'navgoco',
                  expires: false,
                  path: '/'
              },
              slide: {
                  duration: 400,
                  easing: 'swing'
              }
          });
    });
</script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<!--
-->
<script src="/python/js/toc.js"></script>
<script src="/python/js/customscripts.js"></script>
<link rel="shortcut icon" href="/python/images/favicon.ico">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="" href="/python/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });
            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });
            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });
        });
    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    
    </head>
    <body>
        <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div id="sticky" class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-book fa-lg navbar-brand" href="/python/index.html">&nbsp;<span class="projectTitle"> Data Science with Python</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">CDSLab<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
                                
                                <li><a href="https://www.cdslab.org/#about" target="_blank" rel="noopener">About</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/people" target="_blank" rel="noopener">People</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/research" target="_blank" rel="noopener">Research</a></li>
                                
                                
                            </ul>
                        </li>
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
                                
                                <li><a href="https://www.cdslab.org/matlab/" target="_blank" rel="noopener">MATLAB Programming</a></li>
                                
                                
                                
                                <li><a href="https://www.cdslab.org/python/" target="_blank" rel="noopener">Python Programming</a></li>
                                
                                
                            </ul>
                        </li>
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">UTA<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                
                                
                                <li><a href="https://www.uta.edu/science/" target="_blank" rel="noopener">College of Science</a></li>
                                
                                
                                
                                <li><a href="https://www.uta.edu/science/" target="_blank" rel="noopener">Data Science</a></li>
                                
                                
                                
                                <li><a href="https://www.uta.edu/physics/" target="_blank" rel="noopener">Physics</a></li>
                                
                                
                            </ul>
                        </li>
                    
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="keyword search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/python/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "/python/search.json",
                                searchResultTemplate: '<li><a href="https://www.cdslab.org{url}" title="Unit testing">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

        <!-- Page Content -->
        <div class="container">
            <div id="main">
                <!-- Content Row -->
                <div class="row">
                    
                    
                        <!-- Sidebar Column -->
                        <div class="col-md-3" id="tg-sb-sidebar">
                            
<ul id="mysidebar" class="sidenav">
    <!--
    -->
    <li class="sidebarTitle">Table of Pages </li>
    
        
            
                <li>
                    <a title="Overview" href="#"><b>Overview</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Preface" href="/python/notes/overview/preface/preface.html">Preface</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Release note 1" href="/python/notes/overview/release-note-1/release-note-1.html">Release note 1</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Release note 2" href="/python/notes/overview/release-note-2/release-note-2.html">Release note 2</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Release note 3" href="/python/notes/overview/release-note-3/release-note-3.html">Release note 3</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Preliminary foundations" href="#"><b>Preliminary foundations</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Version control system" href="/python/notes/preliminary-foundations/version-control-system/version-control-system.html">Version control system</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Programming history" href="/python/notes/preliminary-foundations/programming-history/programming-history.html">Programming history</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Computer program structure" href="/python/notes/preliminary-foundations/computer-program-structure/computer-program-structure.html">Computer program structure</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Python for beginners" href="/python/notes/preliminary-foundations/python-for-beginners/python-for-beginners.html">Python for beginners</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Values, variables, and types" href="#"><b>Values, variables, and types</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="First program" href="/python/notes/values-variables-types/first-program/first-program.html">First program</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Values" href="/python/notes/values-variables-types/values/values.html">Values</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Variables" href="/python/notes/values-variables-types/variables/variables.html">Variables</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Control constructs" href="#"><b>Control constructs</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Branching" href="/python/notes/control-constructs/branching/branching.html">Branching</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Looping" href="/python/notes/control-constructs/looping/looping.html">Looping</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Program units" href="#"><b>Program units</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Functions" href="/python/notes/program-units/functions/functions.html">Functions</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Modules" href="/python/notes/program-units/modules/modules.html">Modules</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Data transfer (I/O)" href="#"><b>Data transfer (I/O)</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Data input methods" href="/python/notes/data-transfer/input/input.html">Data input methods</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Data output methods" href="/python/notes/data-transfer/output/output.html">Data output methods</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Errors and exceptions" href="#"><b>Errors and exceptions</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Exception handling" href="/python/notes/exceptions-errors/exception-handling/exception-handling.html">Exception handling</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li class="active"><a title="Unit testing" href="/python/notes/exceptions-errors/unit-testing/unit-testing.html">Unit testing</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Object-oriented programming" href="#"><b>Object-oriented programming</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Instantiation" href="/python/notes/object-oriented-programming/instantiation/instantiation.html">Instantiation</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Encapsulation" href="/python/notes/object-oriented-programming/encapsulation/encapsulation.html">Encapsulation</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Inheritance" href="/python/notes/object-oriented-programming/inheritance/inheritance.html">Inheritance</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Polymorphism" href="/python/notes/object-oriented-programming/polymorphism/polymorphism.html">Polymorphism</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Abstraction" href="/python/notes/object-oriented-programming/abstraction/abstraction.html">Abstraction</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Scientific Computing" href="#"><b>Scientific Computing</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Vectorization and array computing" href="/python/notes/scientific-computing/vectorization/vectorization.html">Vectorization and array computing</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Interoperation" href="/python/notes/scientific-computing/interoperation/interoperation.html">Interoperation</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Visualization Techniques" href="#"><b>Visualization Techniques</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Overview" href="/python/notes/visualization/overview/overview.html">Overview</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="2D plotting" href="/python/notes/visualization/2d/2d.html">2D plotting</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Probabilistic Modeling" href="#"><b>Probabilistic Modeling</b></a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Random numbers" href="/python/notes/probabilistic-modeling/random-numbers/random-numbers.html">Random numbers</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Monte Carlo" href="/python/notes/probabilistic-modeling/monte-carlo/monte-carlo.html">Monte Carlo</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
    
    <!-- if you aren't using the accordion, uncomment this block:
    -->
    <p class="external">
        <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
    </p>
</ul>
<!--
This highlights the active parent class in the navgoco sidebar. 
This is critical so that the parent expands when you're viewing a page.
This must appear below the sidebar code above.
Otherwise, if placed inside customscripts.js,
the script runs before the sidebar code runs and the class never gets inserted.
-->
<script>$("li.active").parents('li').toggleClass("active");</script>

                        </div>
                        
                    
                    <!-- Content Column -->
                    <div class="col-md-9" id="tg-sb-content">
                        <div class="post-header">
   <h1 class="post-title-main">Unit testing</h1>
</div>

<div class="post-content">
    
        <div class="summary">This note aims at providing a brief introduction to the concept of Unit Testing in computer programming and the unit testing frameworks in Python.</div>
    
    
        <br>
        
<script>
    $( document ).ready(function() {
        // Handler for .ready() called.
        $('#toc').toc({ minimumHeaders: 0 
                      , listType: 'ol'
                      , showSpeed: 0
                      , headers: 'h2,h3,h4,h5,h6'
        });
        /* the following offset helps account for the space taken up by the floating toolbar. */
        $('#toc').on('click', 'a', function() {
            var target = $(this.getAttribute('href')), scroll_target = target.offset().top$(window).scrollTop(scroll_target - 10);
            return false
        })
    });
</script>

<div id="toc"></div>

    
    
    <h2 id="code-verification-and-unit-testing">Code verification and unit testing</h2>

<p>In the previous sections we discussed the process of creating modules and collecting all functions in one file as a personal user-defined <strong>Python module</strong> that can be used later. As soon as the list of your codes and functions grow, you will need to have <strong>a unified way of ensuring all your functions work appropriately, regardless of the potential future internal changes that are made to the functions</strong>. This is called <strong>unit testing</strong>: <em>a software development process in which the smallest testable parts of an application, called <strong>units</strong>, are individually and independently scrutinized for proper operation</em>. Unit testing can be done manually, but if you have a long list of functions (which you most often have), you’d want to automate the testing process.</p>

<p>The grand goal in unit testing is to reduce the risk of encountering potential problems when running the code in the smallest possible units of the code. This means,</p>
<ol>
  <li>ensuring the code has the <strong>correct behavior</strong> when given the proper input data.</li>
  <li>ensuring the <strong>code robustness</strong> to exceptions and invalid input data, meaning that it does not crash when it reaches unexpected situations during the code execution and gracefully handles the error, without interruption.</li>
</ol>

<p>Because of the goals for which the unit tests are designed, they are mostly written and used by the developers of the code.</p>

<h2 id="unit-test-frameworks">Unit test frameworks</h2>

<p>There are many ways to write tests for codes. Now, if you asked each software developer to write a unit test for specific software, each would likely come up with their own set of rules and tests of the software. You will end up with many tests, that will generally only be usable by the developer that wrote the tests. That is why you should select a unit test framework. A unit test framework provides consistency for how the unit tests for your project are written. There are many test frameworks to choose from for just about any language you want to program with, including Python.</p>

<p>Just like the case for the choice of programming language, almost every programmer has a strong opinion their own as to which test framework is the best. Research what’s out there and use the one that meets the needs of your organization (For example, I had once an experienced Python programmer in my computer programming class, who did not like any of the existing unit-testing frameworks in Python and wanted to write his own unit-test from scratch).</p>

<p>The framework will provide a consistent testing structure to create maintainable tests with reproducible results. From a product-quality and business point of view, those are the most valuable reasons to use a unit test framework. When you write software, you should also think of a quick and simple way to develop and verify your logic in isolation. Once you make sure you have it working solidly by itself, then you can proceed to integrate it into the larger project solutions with great confidence.</p>

<p>Python offers three unit testing frameworks,</p>
<ol>
  <li><a href="https://docs.python.org/2/library/unittest.html" target="_blank"><strong>unittest</strong></a> (Python’s standard unit testing framework)</li>
  <li><a href="http://nose.readthedocs.io/en/latest/index.html" target="_blank"><strong>nose</strong></a></li>
  <li><a href="https://docs.pytest.org/en/latest/" target="_blank"><strong>pytest</strong></a></li>
</ol>

<p>which automate as much as possible the process of testing all of your codes, whenever required. The last, <code class="highlighter-rouge">pytest</code> appears to be the most popular unit testing framework as of today.</p>

<h2 id="conventions-for-test-functions">Conventions for test functions</h2>

<p>The simplest way of using the testing frameworks (e.g., pytest or nose) is to write a set of test functions, scattered around in files, such that pytest or nose can automatically find and run all of these test functions. To achieve the goal, the test functions need to follow certain conventions:</p>
<ol>
  <li>The name of a test function starts with <code class="highlighter-rouge">test_</code>.</li>
  <li>A test function cannot take any arguments.</li>
  <li>Any test must be formulated as a boolean condition.</li>
  <li>An <code class="highlighter-rouge">AssertionError</code> exception is raised if the boolean condition is <code class="highlighter-rouge">False</code> (i.e., when the test fails).<br />
<br /></li>
</ol>

<h2 id="testing-function-accuracy">Testing function accuracy</h2>

<p>Suppose we have written the following function which runs the Newton’s method for solving an algebraic equation of the form $f(x)=0$, and we would like to write a test function that ensures its correct behavior.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-7</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># iteration counter</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">n</span>
</code></pre></div></div>

<p>Our goal is to write a function that tests the validity of the output of the function for a special case for which we know the results a priori. In the case of the above code, the function output is a not a fixed result, but an approximate float number $x_0$ which satisfies the condition $f(x_0)&lt;\epsilon$ where $\epsilon$ is a prescribed number close to zero. Therefore, we have to first come up with a mathematical test input function to the function <code class="highlighter-rouge">newton</code>, for which we have calculated the correct answer a priori, and we want to make sure if the above code gives the same answer. Since the output of the function <code class="highlighter-rouge">newton</code> is a float that depends on the machine precision, we cannot expect the function to output the same result every time the code is run on any computer. Therefore, we have to define our test such that the function passes the test even if the result is not exactly what we expect, but still close enough to the correct answer. Here is an example test function for the above code using the <code class="highlighter-rouge">sin(x)</code> function as the test input function to <code class="highlighter-rouge">newton()</code>,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_newton_sin</span><span class="p">():</span>
    
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="n">x_ref</span> <span class="o">=</span> <span class="mf">0.000769691024206</span>
    <span class="n">f_x_ref</span> <span class="o">=</span> <span class="mf">0.000769690948209</span>
    <span class="n">n_ref</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">f_x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-2</span><span class="p">)</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-15</span> <span class="c"># tolerance for comparing real numbers</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_ref</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="p">,</span> <span class="s">"The test for the value of x_0 failed"</span> <span class="c"># is x correct?</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_x_ref</span> <span class="o">-</span> <span class="n">f_x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="p">,</span> <span class="s">"The test for the function value failed"</span> <span class="c"># is f_x correct?</span>
    <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">,</span> <span class="s">"The test for the number of iterations failed"</span> <span class="c"># is f_x correct? # is n correct?</span>
</code></pre></div></div>

<p>Note that in the above test function, the function name begins with <code class="highlighter-rouge">test_</code>, takes no arguments, and raises an <code class="highlighter-rouge">assertionError</code> at the end. Now if you run the test,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_newton_sin</span><span class="p">()</span>
</code></pre></div></div>

<p>you will notice that the function passed the test. However, if in the above test, we set <code class="highlighter-rouge">eps=1E-10</code>, and run the test again, you will get an assertion error like the following,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
&lt;ipython-input-20-8be9faac8d8e&gt; in &lt;module&gt;()
----&gt; 1 test_newton_sin()

&lt;ipython-input-18-263651ba410f&gt; in test_newton_sin()
     14     x, f_x, n = newton(f, dfdx, x=-pi/3, eps=1E-10)
     15     tol = 1E-15 # tolerance for comparing real numbers
---&gt; 16     assert abs(x_ref - x) &lt; tol , "The test for the value of x_0 failed" # is x correct?
     17     assert abs(f_x_ref - f_x) &lt; tol , "The test for the function value failed" # is f_x correct?
     18     assert n == 3 , "The test for the number of iterations failed" # is f_x correct? # is n correct?

AssertionError: The test for the value of x_0 failed
</code></pre></div></div>

<p>One could also write exact tests for the function <code class="highlighter-rouge">newton</code> which test for an exact result which is known a priori, for example, a mathematical linear input function to <code class="highlighter-rouge">newton</code>.<br />
<br /></p>

<h2 id="testing-function-robustness">Testing function robustness</h2>

<p>The above <code class="highlighter-rouge">newton</code> function is very basic and suffers from several problems:</p>
<ul>
  <li>for divergent iterations, it will iterate forever,</li>
  <li>it can divide by zero in f(x)/dfdx(x),</li>
  <li>it can perform integer division in f(x)/dfdx(x),</li>
  <li>it does not test whether the arguments have acceptable types and values.</li>
</ul>

<p>A more robust implementation dealing with these potential problems would look like the following:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">Newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-7</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">f</span><span class="p">):</span> <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span> <span class="s">'f is </span><span class="si">%</span><span class="s">s, should be function or class with __call__'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">dfdx</span><span class="p">):</span> <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span> <span class="s">'dfdx is </span><span class="si">%</span><span class="s">s, should be function or class with __call__'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">dfdx</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maxit</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span> <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span> <span class="s">'maxit is </span><span class="si">%</span><span class="s">s, must be int'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">maxit</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">maxit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span> <span class="s">'maxit=</span><span class="si">%</span><span class="s">d &lt;= 0, must be &gt; 0'</span> <span class="o">%</span> <span class="n">maxit</span> <span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># iteration counter</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">eps</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">maxit</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">except</span> <span class="nb">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ZeroDivisionError</span><span class="p">(</span> <span class="s">'dfdx(</span><span class="si">%</span><span class="s">g)=</span><span class="si">%</span><span class="s">g - cannot divide by zero'</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">n</span>
</code></pre></div></div>

<p>Now, for this more robust code (than the earlier version: <code class="highlighter-rouge">newton</code>), we have to also write a set of tests, examining the robustness of the code, subject to potential exceptions. For example, one can write a test function that examines the behavior of <code class="highlighter-rouge">Newton</code> subject to an input mathematical function that is known to lead to divergent (infinite) iterations, if the initial starting point $x$ is not sufficiently close to the root of the function. One such example is $f(x)=tanh(x)$, for which a starting search value of $x=20$ would lead to infinite iterations in Newton’s method. So we can set <code class="highlighter-rouge">maxit=12</code> in our robust <code class="highlighter-rouge">Newton</code> code, and test that the actual number of iterations reaches this limit. Given our prior knowledge for this function, that the value of $x$ will also diverge after 12 iterations, we could also add a test for the value of $x$, like the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_Newton_divergence</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">tanh</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">tanh</span>
    <span class="n">dfdx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">10.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">x</span><span class="p">,</span> <span class="n">f_x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-4</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">12</span>
    <span class="k">assert</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1E+50</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_Newton_divergence</span><span class="p">()</span>
</code></pre></div></div>

<p>The example above only tests for the robustness of <code class="highlighter-rouge">Newton()</code> in handling divergent situations. For other potential problems, one has to write other test functions, some which will be given as exercise.</p>

<h2 id="summary-unit-testing">Summary: unit testing</h2>

<p>Unit testing is a component of <a href="https://en.wikipedia.org/wiki/Test-driven_development" target="_blank">test-driven development (TDD)</a>, a pragmatic methodology that takes a meticulous approach to build a product using <em>continual testing and revision</em>.</p>

<p>Unit testing has a steep learning curve. The programmer or the development-team needs to learn what unit testing is, how to unit test, what to unit test and how to use automated software tools to facilitate the process on an on-going basis.  The great benefit to unit testing is that the earlier a problem is identified, the fewer compound errors occur. A compound error is one that doesn’t seem to break anything at first but eventually conflicts with something down the line and results in a problem.</p>

<p>There is a lot more to unit testing and the existing Python frameworks for it than we discussed here. However, covering all those topics would require a dedicated course for unit testing, which is certainly beyond the capacity of this course. But if you are interested to know more, I recommend you to refer to one of the three unit-testing frameworks mentioned <a href="#unit-test-frameworks">above</a>. There are also many books already written on this topic.</p>

    
    
    <div style="margin-top:3rem">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname
    
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>


</div>
<hr class="shaded"/>
<footer>
    <div class="row">
        <div class="social-icons">

    
    <span class="social-icon">
        <a href="https://facebook.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-facebook fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

    
    <span class="social-icon">
        <a href="https://github.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

    

    
    <span class="social-icon">
        <a href="https://instagram.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-instagram fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

    
    <span class="social-icon">
        <a href="https://medium.com/cdslab" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-medium fa-stack-xs"></i>
                <!--
                -->
            </span>
        </a>
    </span>
    

    
    <span class="social-icon">
        <a href="https://twitter.com/cdslaborg" target="_blank">
            <span class="fa-stack fa-lg">
                
<i class="fa fa-circle-thin fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-xs"></i>
            </span>
        </a>
    </span>
    

</div>

        <div class="col-lg-12 footer">
            &copy;2019 <a href="https://www.cdslab.org" target="_blank">Computational Data Science Lab</a><br />
            Site last generated: October 10, 2019 <br />
            
                <span>Page last updated:</span>July 9, 2019<br/>
            
        <p>
            <a href="https://www.cdslab.org" target="_blank"><img class="footerlogo" src="/python/images/logo.png" }}" alt="cdslab.org" /></a>
            <!-- Start of statc -->
<div style="color: #ffffff; float: none; width: 100%;">
    <span style="font-size:0.8em">visitor count: 
        <script type="text/javascript">
            var sc_project=12046867; 
            var sc_invisible=0; 
            var sc_security="c4544640"; 
            var sc_text=3; 
            var scJsHost = "https://";
            document.write("<sc"+"ript type='text/javascript' src='" +
            scJsHost+
            "statcounter.com/counter/counter.js'></"+"script>");
        </script>
    </span>
</div>
<!-- End of statc -->
        </p>
        </div>
    </div>
    <!--Mathjax LaTeX engine-->
    
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        MathJax.Hub.Config({
            config: ["MMLorHTML.js"],
            extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
            jax: ["input/TeX"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: false
            },
            TeX: {
                TagSide: "right",
                TagIndent: ".8em",
                MultLineWidth: "85%",
                equationNumbers: {
                autoNumber: "AMS",
                },
                unicode: {
                fonts: "STIXGeneral,'Arial Unicode MS'" 
                }
            },
            showProcessingMessages: false
        });
    </script>
    <style TYPE="text/css">
        code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
    </style>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
            }
        });
        MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
</footer>

                    </div>
                    <!-- /.row -->
                </div>
                <!-- /.container -->
            </div>
            <!-- /#main -->
        </div>
        
    </body>
    
</html>
